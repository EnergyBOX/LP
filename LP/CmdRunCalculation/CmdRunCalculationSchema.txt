START
   │
   ▼
Отримати документ Revit (doc)
   │
   ▼
Отримати глобальний параметр R = LP_Radius
   │
   ├─ R <= 0? ──► Показати повідомлення "Параметр не знайдено або <= 0" ──► FAILED
   │
   ▼
Знайти елементи з LP_Is_LightningRod
   │
   ├─ немає елементів? ──► Показати повідомлення "Блискавкоприймачі не знайдені" ──► SUCCEEDED
   │
   ▼
Визначити верхівки блискавкоприймачів
   │
   ├─ немає верхівок? ──► Показати повідомлення "Не вдалося визначити верхівки" ──► SUCCEEDED
   │
   ▼
Для кожного трикутника з верхівок:
   │
   ▼
Обчислити перетин трьох сфер (IntersectsThreeSpheres)
   │
   ▼
Перевірити:
   │   ├─ Чи верхівка всередині іншої сфери? (IsTipInsideSphere)
   │   └─ Чи сфера вже розміщена? (IsSphereAlreadyPlaced)
   │
   ├─ Якщо так → пропустити
   │
   ▼
Вставити сферу у Revit (FamilyUtils.PlaceSphereVoid)
   │
   ▼
Підрахувати кількість розміщених сфер
   │
   ▼
Кінець циклів
   │
   ▼
Показати звіт:
"Блискавкоприймачів: X
Верхівок: Y
Розміщено сфер: Z"
   │
   ▼
END
